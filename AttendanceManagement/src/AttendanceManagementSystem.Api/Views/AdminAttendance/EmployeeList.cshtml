@model AttendanceManagementSystem.Api.Models.EmployeeListViewModel

<div class="card">
    <div class="card-header">
        <h3 class="card-title">Список сотрудников</h3>

        @{
            var currentYear = DateTime.Now.Year;
            var currentMonth = 11;
        }

        @* 1. 'Создать' tugmasi formasi (Yashil) *@
        <form asp-controller="AdminAttendance"
              asp-action="ViewCreateCalendarForAll"
              asp-route-year="@currentYear"
              asp-route-month="@currentMonth"
              method="get"
              style="float: right; margin-left: 10px;">

            <button type="submit"
                    onclick="return confirm('ВНИМАНИЕ! Вы уверены, что хотите сгенерировать календарь для ВСЕХ активных сотрудников на текущий месяц? Все предыдущие расчеты будут перезаписаны.')"
                    class="btn btn-success">
                <i class="fas fa-calendar-plus"></i> Создать Календарь для ВСЕХ (@currentYear-@currentMonth)
            </button>
        </form>

        @* 2. 'Обновить' tugmasi formasi (To'q Sariq/Oltin) *@
        <form asp-controller="AdminAttendance"
              asp-action="ViewUpdateCalendarForAll"
              asp-route-year="@currentYear"
              asp-route-month="@currentMonth"
              method="get"
              style="float: right;">

            <button type="submit"
                    onclick="return confirm('ВНИМАНИЕ! Вы уверены, что хотите обновить календарь для ВСЕХ активных сотрудников на текущий месяц? Будут обновлены только поля с данными о посещаемости (время первого входа).')"
                    class="btn btn-warning">
                @* **O'zgartirish: btn-warning (To'q Sariq/Oltin rang) qo'yildi** *@
                <i class="fas fa-calendar-alt"></i> Обновить Календарь для ВСЕХ (@currentYear-@currentMonth)
            </button>
        </form>

    </div>
</div>

<table class="table">
    <thead>
        <tr>
            <th>ФИО Сотрудника</th>
            <th style="width: 150px;">Просмотр табеля</th>
            <th style="width: 120px;">Управление</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var employee in Model.Employees)
        {
            <tr>
                <td>@employee.FullName</td>

                <td>
                    @{
                        var currentYearForLink = DateTime.Now.Year;
                        var currentMonthForLink = 11;
                    }

                    <a asp-controller="AdminAttendance"
                       asp-action="ViewCalendar"
                       asp-route-username="@employee.FullName"
                       asp-route-year="@currentYearForLink"
                       asp-route-month="@currentMonthForLink"
                       class="btn btn-info btn-sm">
                        <i class="fas fa-calendar-alt"></i> Просмотр табеля
                    </a>
                </td>

                <td>
                    @{
                        var confirmMessage = $"ВНИМАНИЕ! Вы действительно хотите деактивировать сотрудника {employee.FullName}? Он будет удален из списка.";
                    }

                    <a asp-controller="AdminAttendance"
                       asp-action="Inactivate"
                       asp-route-username="@employee.FullName"
                       onclick="return confirm('@confirmMessage')"
                       class="btn btn-danger btn-sm"
                       title="Деактивация сотрудника">
                        <i class="fas fa-user-slash"></i> Inactive
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>